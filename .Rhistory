ggtitle("Gráfico de barras de cantidad de registros de presencia por especie") +
xlab("Nombre de especie") +
ylab("Longitud") +
labs(caption = "Fuente: Sinac") +
theme_economist()
# Convertir el gráfico de ggplot2 a plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
datos_filtrados <- riqueza_especies_orquideas_area %>%
filter(riqueza_especies_orquideas > 11)
grafico_barras_ggplot2 <-
riqueza_especies_orquideas_area |>
ggplot(aes(x = reorder(nombre_ac,-riqueza_especies_orquideas), y = riqueza_especies_orquideas)) +
geom_col(
aes(
text = paste0(
"Riqueza de especies de orquídeas en áreas de conservación: ", round(after_stat(y), 2)
)
)
) +
ggtitle("Riqueza de especies de orquídeas en áreas de conservación") +
xlab("Áreas de conservación") +
ylab("Riqueza de especies de orquídeas") +
labs(caption = "Fuente: Sinac") +
theme_economist()
# Gráfico de barras plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
datos_filtrados <- riqueza_especies_orquideas_area %>%
filter(riqueza_especies_orquideas > 118)
grafico_barras_ggplot2 <-
riqueza_especies_orquideas_area |>
ggplot(aes(x = reorder(nombre_ac,-riqueza_especies_orquideas), y = riqueza_especies_orquideas)) +
geom_col(
aes(
text = paste0(
"Riqueza de especies de orquídeas en áreas de conservación: ", round(after_stat(y), 2)
)
)
) +
ggtitle("Riqueza de especies de orquídeas en áreas de conservación") +
xlab("Áreas de conservación") +
ylab("Riqueza de especies de orquídeas") +
labs(caption = "Fuente: Sinac") +
theme_economist()
# Gráfico de barras plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
datos_filtrados <- riqueza_especies_orquideas_area %>%
filter(riqueza_especies_orquideas > 1)
grafico_barras_ggplot2 <-
riqueza_especies_orquideas_area |>
ggplot(aes(x = reorder(nombre_ac,-riqueza_especies_orquideas), y = riqueza_especies_orquideas)) +
geom_col(
aes(
text = paste0(
"Riqueza de especies de orquídeas en áreas de conservación: ", round(after_stat(y), 2)
)
)
) +
ggtitle("Riqueza de especies de orquídeas en áreas de conservación") +
xlab("Áreas de conservación") +
ylab("Riqueza de especies de orquídeas") +
labs(caption = "Fuente: Sinac") +
theme_economist()
# Gráfico de barras plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
datos_filtrados <- riqueza_especies_orquideas_area %>%
filter(riqueza_especies_orquideas > 1)
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
datos_filtrados <- riqueza_especies_orquideas_area %>%
filter(riqueza_especies_orquideas > 1)
grafico_barras_ggplot2 <-
riqueza_especies_orquideas_area |>
ggplot(aes(x = reorder(nombre_ac,-riqueza_especies_orquideas), y = riqueza_especies_orquideas)) +
geom_col(
aes(
text = paste0(
"Riqueza de especies de orquídeas en áreas de conservación: ", round(after_stat(y), 2)
)
)
) +
ggtitle("Riqueza de especies de orquídeas en áreas de conservación") +
xlab("Áreas de conservación") +
ylab("Riqueza de especies de orquídeas") +
labs(caption = "Fuente: Sinac") +
theme_economist()
# Gráfico de barras plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
datos_filtrados <- riqueza_especies_orquideas_area %>%
group_by(nombre_ac) %>%
filter(n() > 1) %>%
ungroup()
grafico_barras_ggplot2 <-
riqueza_especies_orquideas_area |>
ggplot(aes(x = reorder(nombre_ac,-riqueza_especies_orquideas), y = riqueza_especies_orquideas)) +
geom_col(
aes(
text = paste0(
"Riqueza de especies de orquídeas en áreas de conservación: ", round(after_stat(y), 2)
)
)
) +
ggtitle("Riqueza de especies de orquídeas en áreas de conservación") +
xlab("Áreas de conservación") +
ylab("Riqueza de especies de orquídeas") +
labs(caption = "Fuente: Sinac") +
theme_economist()
# Gráfico de barras plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
datos_filtrados <- riqueza_especies_orquideas_area %>%
group_by(nombre_ac) %>%
filter(n() > 1) %>%
ungroup(118)
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
datos_filtrados <- riqueza_especies_orquideas_area %>%
group_by(nombre_ac) %>%
filter(n() > 11) %>%
ungroup()
grafico_barras_ggplot2 <-
riqueza_especies_orquideas_area |>
ggplot(aes(x = reorder(nombre_ac,-riqueza_especies_orquideas), y = riqueza_especies_orquideas)) +
geom_col(
aes(
text = paste0(
"Riqueza de especies de orquídeas en áreas de conservación: ", round(after_stat(y), 2)
)
)
) +
ggtitle("Riqueza de especies de orquídeas en áreas de conservación") +
xlab("Áreas de conservación") +
ylab("Riqueza de especies de orquídeas") +
labs(caption = "Fuente: Sinac") +
theme_economist()
# Gráfico de barras plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
datos_filtrados <- riqueza_especies_orquideas_area %>%
group_by(nombre_ac) %>%
filter(n() > 118) %>%
ungroup()
grafico_barras_ggplot2 <-
riqueza_especies_orquideas_area |>
ggplot(aes(x = reorder(nombre_ac,-riqueza_especies_orquideas), y = riqueza_especies_orquideas)) +
geom_col(
aes(
text = paste0(
"Riqueza de especies de orquídeas en áreas de conservación: ", round(after_stat(y), 2)
)
)
) +
ggtitle("Riqueza de especies de orquídeas en áreas de conservación") +
xlab("Áreas de conservación") +
ylab("Riqueza de especies de orquídeas") +
labs(caption = "Fuente: Sinac") +
theme_economist()
# Gráfico de barras plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
grafico_barras_ggplot2 <- riqueza_especies_orquideas_area |>
ggplot(aes(x = reorder(nombre_ac, -riqueza_especies_orquideas), y = riqueza_especies_orquideas)) +
geom_col(
aes(fill = ifelse(riqueza_especies_orquideas == 118, "transparent", "default")),
color = "black",
size = 0.5,
width = 0.6,
alpha = 1,
show.legend = FALSE,
position = "identity",
na.rm = TRUE
) +
scale_fill_manual(values = c("transparent" = "transparent", "default" = "steelblue")) +
ggtitle("Riqueza de especies de orquídeas en áreas de conservación") +
xlab("Áreas de conservación") +
ylab("Riqueza de especies de orquídeas") +
labs(caption = "Fuente: Sinac") +
theme_economist()
# Gráfico de barras plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
riqueza_especies_orquideas_area <- riqueza_especies_orquideas_area %>%
mutate(riqueza_especies_felidos = replace_na(riqueza_especies_felidos, 0))
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
riqueza_especies_orquideas_area <- riqueza_especies_orquideas_area %>%
mutate(riqueza_especies_felidos = replace_na(riqueza_especies_felidos, 0))
#| code-fold: true
#| label: conteo
#| warning: false
#| message: false
orquideas_union_areas <-
st_join(
x = orquideas,
y = dplyr::select(areas, nombre_ac), # selección de columna cod_canton
join = st_within
)
riqueza_especies_orquideas_area <-
orquideas_union_areas |>
st_drop_geometry() |>
group_by(nombre_ac) |>
summarize(riqueza_especies_orquideas = n_distinct(species, na.rm = TRUE))
areas_union_riqueza <-
left_join(
x = areas,
y = dplyr::select(riqueza_especies_orquideas_area, nombre_ac, riqueza_especies_orquideas),
by = "nombre_ac"
) |>
replace_na(list(riqueza_especies_orquideas = 0))
areas_union_riqueza |>
st_drop_geometry() |>
dplyr::select(nombre_ac, riqueza_especies_orquideas) |>
arrange(desc(riqueza_especies_orquideas)) |>
datatable(
colnames = c("Nombre del área de conservación", "Riqueza de especies de orquídeas"),
options = list(
pageLength = 5,
language = list(url = '//cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')
)
)
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
riqueza_especies_orquideas_area <- riqueza_especies_orquideas_area %>%
mutate(riqueza_especies_felidos = replace_na(riqueza_especies_felidos, 0))
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
riqueza_especies_orquideas_area <- riqueza_especies_orquideas_area %>%
mutate(riqueza_especies_area = replace_na(riqueza_especies_area, 0))
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
riqueza_especies_orquideas_area <- riqueza_especies_orquideas_area %>%
mutate( riqueza_especies_orquideas_area = replace_na( riqueza_especies_orquideas_area, 0))
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
riqueza_especies_orquideas_area <- riqueza_especies_orquideas_area %>%
mutate(replace_na( riqueza_especies_orquideas_area, 0))
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
riqueza_especies_orquideas_area <- riqueza_especies_orquideas_area %>%
filter(nombre_ac != "")
grafico_barras_ggplot2 <-
riqueza_especies_orquideas_area |>
ggplot(aes(x = reorder(nombre_ac,-riqueza_especies_orquideas), y = riqueza_especies_orquideas)) +
geom_col(
aes(
text = paste0(
"Riqueza de especies de orquídeas en áreas de conservación: ", round(after_stat(y), 2)
)
)
) +
ggtitle("Riqueza de especies de orquídeas en áreas de conservación") +
xlab("Áreas de conservación") +
ylab("Riqueza de especies de orquídeas") +
labs(caption = "Fuente: Sinac") +
theme_economist()
# Gráfico de barras plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
#| code-fold: true
#| label: grafico1
#| warning: false
#| message: false
# Calcular la frecuencia de cada especie de orquídea
orquideas_frecuentes <- orquideas_union_areas |>
group_by(species)  |>
summarise(frecuencia = n())  |>
arrange(desc(frecuencia)) |>
top_n(n = 10, wt = frecuencia)
# Filtrar solo las especies de orquídeas más frecuentes
orquideas_filtradas <- orquideas_union_areas |>
filter(species %in% orquideas_frecuentes$species)
# Ordenar las especies de orquídeas de mayor a menor frecuencia
orquideas_filtradas$species <- factor(orquideas_filtradas$species,
levels = orquideas_frecuentes$species)
# Crear el gráfico de barras con ggplot2
grafico_barras_ggplot2 <- orquideas_filtradas |>
ggplot(aes(x = fct_rev(fct_infreq(species)), y = decimalLongitude)) +
geom_col(
aes(
text = paste0(
"Riqueza de especies de orquídeas en áreas de conservación: ", round(after_stat(y), 2)
)
),
position = position_stack(reverse = TRUE)
) +
ggtitle("Gráfico de barras de cantidad de registros de presencia por especie") +
xlab("Nombre de especie") +
ylab("Longitud") +
labs(caption = "Fuente: Sinac") +
theme_economist()
# Convertir el gráfico de ggplot2 a plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
#| code-fold: true
#| label: carga-biblioteca
#| warning: false
#| message: false
library(tidyverse)
library(plotly)
library(DT)
library(readr)
library(hrbrthemes)
library(ggthemes)
library(sf)
library(raster)
library(rgdal)
library(leaflet)
library(leaflet.extras)
library(leafem)
library(viridisLite)
#| code-fold: true
#| label: grafico1
#| warning: false
#| message: false
orquideas_top10 <- orquideas_union_areas  |>
count(species, sort = TRUE) |>
top_n(10, n)
grafico_barras_ggplot2 <- orquideas_top10 |>
ggplot(aes(x = reorder(species, -n), y = n)) +
geom_bar(stat = "identity", fill = "steelblue",
aes(text = paste0("Cantidad de registros de presencia de especies: ", n))) +
ggtitle("Gráfico de barras de cantidad de registros de presencia por especie, para las 10 especies de orquídeas") +
xlab("Especie") +
ylab("Cantidad de registros de presencia") +
labs(caption = "Fuente: Sinac") +
theme_economist()
# Gráfico de barras plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
grafico_barras_ggplot2 <- orquideas_top10 |>
ggplot(aes(x = reorder(species, -n), y = n)) +
geom_bar(stat = "identity", fill = "steelblue",
aes(text = paste0("Cantidad de registros de presencia de especies: ", n))) +
ggtitle("Gráfico de barras de cantidad de registros de presencia por especie, para las 10 especies de orquídeas") +
xlab("Especie") +
ylab("Cantidad de registros de presencia") +
labs(caption = "Fuente: Sinac") +
theme(axis.text.x = element_text(angle = 90))
theme_economist(
grafico_barras_ggplot2 <- orquideas_top10 |>
ggplot(aes(x = reorder(species, -n), y = n)) +
geom_bar(stat = "identity", fill = "steelblue",
aes(text = paste0("Cantidad de registros de presencia de especies: ", n))) +
ggtitle("Gráfico de barras de cantidad de registros de presencia por especie, para las 10 especies de orquídeas") +
xlab("Especie") +
ylab("Cantidad de registros de presencia") +
labs(caption = "Fuente: Sinac") +
theme(axis.text.x = element_text(angle = 90))
theme_economist()
grafico_barras_ggplot2 <- orquideas_top10 |>
ggplot(aes(x = reorder(species, -n), y = n)) +
geom_bar(stat = "identity", fill = "steelblue",
aes(text = paste0("Cantidad de registros de presencia de especies: ", n))) +
ggtitle("Gráfico de barras de cantidad de registros de presencia por especie, para las 10 especies de orquídeas") +
xlab("Especie") +
ylab("Cantidad de registros de presencia") +
labs(caption = "Fuente: Sinac") +
theme(axis.text.x = element_text(angle = 90))
theme_economist()+
grafico_barras_ggplot2 <- orquideas_top10 |>
ggplot(aes(x = reorder(species, -n), y = n)) +
geom_bar(stat = "identity", fill = "steelblue",
aes(text = paste0("Cantidad de registros de presencia de especies: ", n))) +
ggtitle("Gráfico de barras de cantidad de registros de presencia por especie, para las 10 especies de orquídeas") +
xlab("Especie") +
ylab("Cantidad de registros de presencia") +
labs(caption = "Fuente: Sinac") +
theme(axis.text.x = element_text(angle = 90)) +
theme_economist()
grafico_barras_ggplot2 <- orquideas_top10 |>
ggplot(aes(x = reorder(species, -n), y = n)) +
geom_bar(stat = "identity", fill = "steelblue",
aes(text = paste0("Cantidad de registros de presencia de especies: ", n))) +
ggtitle("Gráfico de barras de cantidad de registros de presencia por especie, para las 10 especies de orquídeas") +
xlab("Especie") +
ylab("Cantidad de registros de presencia") +
labs(caption = "Fuente: Sinac") +
theme(axis.text.x = element_text(angle = 90)) + coord_flip() +
theme_economist()
grafico_barras_ggplot2 <- orquideas_top10 |>
ggplot(aes(x = reorder(species, -n), y = n)) +
geom_bar(stat = "identity", fill = "steelblue",
aes(text = paste0("Cantidad de registros de presencia de especies: ", n))) +
ggtitle("Gráfico de barras de cantidad de registros de presencia por especie, para las 10 especies de orquídeas") +
xlab("Especie") +
ylab("Cantidad de registros de presencia") +
labs(caption = "Fuente: Sinac") +
theme(axis.text.x = element_text(angle = 90)) + coord_flip() +
grafico_barras_ggplot2 <- orquideas_top10 |>
ggplot(aes(x = reorder(species, -n), y = n)) +
geom_bar(stat = "identity", fill = "steelblue",
aes(text = paste0("Cantidad de registros de presencia de especies: ", n))) +
ggtitle("Gráfico de barras de cantidad de registros de presencia por especie, para las 10 especies de orquídeas") +
xlab("Especie") +
ylab("Cantidad de registros de presencia") +
labs(caption = "Fuente: Sinac") +
theme(axis.text.x = element_text(angle = 90)) + coord_flip()
grafico_barras_ggplot2 <- orquideas_top10 |>
ggplot(aes(x = reorder(species, -n), y = n)) +
geom_bar(stat = "identity", fill = "steelblue",
aes(text = paste0("Cantidad de registros de presencia de especies: ", n))) +
ggtitle("Gráfico de barras de cantidad de registros de presencia por especie, para las 10 especies de orquídeas") +
xlab("Especie") +
ylab("Cantidad de registros de presencia") +
labs(caption = "Fuente: Sinac") +
coord_flip() +
theme_economist()
grafico_barras_ggplot2 <- orquideas_top10 |>
ggplot(aes(x = reorder(species, -n), y = n)) +
geom_bar(stat = "identity", fill = "steelblue",
aes(text = paste0("Cantidad de registros de presencia de especies: ", n))) +
ggtitle("Gráfico de barras de cantidad de registros de presencia por especie, para las 10 especies de orquídeas") +
xlab("Especie") +
ylab("Cantidad de registros de presencia") +
labs(caption = "Fuente: Sinac") +
theme_economist() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
#| code-fold: true
#| label: grafico1
#| warning: false
#| message: false
orquideas_top10 <- orquideas_union_areas  |>
count(species, sort = TRUE) |>
top_n(10, n)
grafico_barras_ggplot2 <- orquideas_top10 |>
ggplot(aes(x = reorder(species, -n), y = n)) +
geom_bar(stat = "identity", fill = "steelblue",
aes(text = paste0("Cantidad de registros de presencia de especies: ", n))) +
ggtitle("Gráfico de barras de cantidad de registros de presencia por especie, para las 10 especies de orquídeas") +
xlab("Especie") +
ylab("Cantidad de registros de presencia") +
labs(caption = "Fuente: Sinac") +
theme_economist() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
# Gráfico de barras plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
#| code-fold: true
#| label: grafico
#| warning: false
#| message: false
riqueza_especies_orquideas_area <- riqueza_especies_orquideas_area |>
filter(nombre_ac != "")
grafico_barras_ggplot2 <-
riqueza_especies_orquideas_area |>
ggplot(aes(x = reorder(nombre_ac,-riqueza_especies_orquideas), y = riqueza_especies_orquideas)) +
geom_col(
aes(
text = paste0(
"Riqueza de especies de orquídeas en áreas de conservación: ", round(after_stat(y), 2)
)
)
) +
ggtitle("Riqueza de especies de orquídeas en áreas de conservación") +
xlab("Áreas de conservación") +
ylab("Riqueza de especies de orquídeas") +
labs(caption = "Fuente: Sinac") +
theme_economist() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
# Gráfico de barras plotly
ggplotly(grafico_barras_ggplot2, tooltip = "text") |>
config(locale = 'es')
